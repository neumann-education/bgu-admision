<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admission Application Form</title>
    <!-- SweetAlert2 -->
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome (opcional) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        :root {
            --primary-color: #0078D4;
            --secondary-color: #106EBE;
            --accent-color: #2B88D8;
            --background-color: #F5F5F5;
            --text-color: #323130;
            --border-color: #EDEBE9;
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 8px 16px rgba(0, 0, 0, 0.12);
            --gradient: linear-gradient(135deg, #0078D4, #106EBE);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            /* Cambia la siguiente línea: */
            background: var(--background-color) url('https://cdn.bitrix24.es/b15495391/landing/164/164ee2aa6aea49cb44d001c7da59a84c/beta-port-01_1x.jpg') no-repeat center center / cover;
            background-attachment: fixed; /* Opcional: hace que el fondo no se mueva al hacer scroll */
            color: var(--text-color);
            line-height: 1.4;
            min-height: 100vh; /* Importante para que el fondo cubra toda la altura */
        }

        .container {
            max-width: 750px;
            margin: 1rem auto;
            padding: 0 1rem;
        }

        .form-card {
            background: white;
            border-radius: 4px;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            transition: transform 0.2s ease;
        }

        .form-card:hover {
            transform: translateY(-2px);
        }

        .form-header {
            background: var(--gradient);
            padding: 1.5rem;
            text-align: center;
        }

        .form-header h1 {
            color: white;
            font-size: 1.8rem;
            font-weight: 500;
            margin-bottom: 0.3rem;
            letter-spacing: 0.3px;
        }

        .form-header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.95rem;
        }

        .section {
            background: white;
            margin: 0.8rem;
            padding: 1.2rem;
            border-radius: 4px;
            box-shadow: var(--shadow-sm);
            transition: all 0.2s ease;
            border: 1px solid var(--border-color);
            animation: fadeInUp 0.3s ease-out forwards;
        }

        .section:hover {
            box-shadow: var(--shadow-md);
        }

        .section h2 {
            color: var(--primary-color);
            font-size: 1.3rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 0.6rem;
            font-weight: 500;
        }

        .section h2 i {
            color: var(--accent-color);
            font-size: 1.2rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-group {
            margin-bottom: 0.8rem;
        }

        label {
            display: block;
            margin-bottom: 0.4rem;
            font-weight: 500;
            color: var(--text-color);
            font-size: 0.9rem;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        select {
            width: 100%;
            padding: 0.7rem 0.8rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 0.95rem;
            transition: all 0.2s ease;
            background: white;
            color: var(--text-color);
        }

        input:focus,
        select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.1);
            outline: none;
        }

        input::placeholder {
            color: #A19F9D;
        }

        .requirements label,
        .ferpa-requirements label {
            display: flex;
            align-items: flex-start;
            padding: 0.8rem;
            background: #FAFAFA;
            border-radius: 4px;
            margin-bottom: 0.6rem;
            transition: all 0.2s ease;
            cursor: pointer;
            border: 1px solid var(--border-color);
        }

        .requirements label:hover,
        .ferpa-requirements label:hover {
            background: white;
            border-color: var(--primary-color);
            box-shadow: var(--shadow-sm);
        }

        input[type="checkbox"] {
            margin: 0.2rem 0.8rem 0 0;
            width: 1.2rem;
            height: 1.2rem;
            border-radius: 3px;
            cursor: pointer;
            accent-color: var(--primary-color);
            appearance: none;
            -webkit-appearance: none;
            border: 2px solid var(--primary-color);
            position: relative;
            display: inline-block;
            vertical-align: middle;
            flex-shrink: 0;
        }

        .requirements label {
            display: none; /* Requirements labels hidden by default */
        }

        .ferpa-requirements label {
            display: flex; /* Ferpa labels visible by default (within the FERPA section) */
        }

        input[type="checkbox"]:checked {
            background-color: var(--primary-color);
        }

        input[type="checkbox"]:checked:after {
            content: '';
            position: absolute;
            left: 4px;
            top: 1px;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }

        .signature-container,
        .signature-container-parent {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        #signature-pad,
        #signature-pad-parent {
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: white;
            width: 100%;
            max-width: 400px;
            height: 200px;
            cursor: crosshair;
            box-shadow: var(--shadow-sm);
        }

        .btn-group {
            display: flex;
            gap: 0.8rem;
            margin-top: 0.8rem;
        }

        button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.95rem;
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
        }

        button.secondary {
            background: #F3F2F1;
            color: var(--text-color);
        }

        button.secondary:hover {
            background: #E1DFDD;
        }

        .submit-btn {
            background: var(--primary-color);
            color: white;
            width: 100%;
            padding: 1rem;
            font-size: 1rem;
            margin-top: 1.5rem;
            letter-spacing: 0.3px;
        }

        .submit-btn:hover {
            background: var(--secondary-color);
            box-shadow: var(--shadow-md);
        }

        .guardian-section {
            display: none;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
        }

        .guardian-section.visible {
            display: block;
            max-height: 2000px; /* Adjust as needed */
        }

        .section-note {
            color: #605E5C;
            font-size: 0.85rem;
            margin-bottom: 0.8rem;
            font-style: italic;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        input:disabled,
        select:disabled {
            background-color: #F3F2F1;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .hidden {
            display: none;
        }

        [data-tooltip] {
            position: relative;
        }

        [data-tooltip]:hover::before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 0.4rem 0.8rem;
            background: var(--text-color);
            color: white;
            border-radius: 4px;
            font-size: 0.85rem;
            white-space: nowrap;
            z-index: 10;
        }

        @media (max-width: 768px) {
            .container {
                margin: 0.5rem;
                padding: 0.5rem;
            }

            .form-header {
                padding: 1.2rem 1rem;
            }

            .form-header h1 {
                font-size: 1.5rem;
            }

            .section {
                margin: 0.6rem;
                padding: 1rem;
            }

            .form-row {
                grid-template-columns: 1fr;
                gap: 0.8rem;
            }

            button {
                padding: 0.7rem 1.2rem;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="form-card">
            <div class="form-header">
                <h1>Admission Application Form</h1>
                <p>Please complete all required information to process your application</p>
            </div>

            <form id="admissionForm" onsubmit="submitForm(event)">
                <!-- Personal Information Section -->
                <div class="section">
                    <h2><i class="fas fa-user"></i> PERSONAL INFORMATION</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Last Name:</label>
                            <input type="text" name="lastName" required placeholder="Enter your last name">
                        </div>
                        <div class="form-group">
                            <label>First Name:</label>
                            <input type="text" name="firstName" required placeholder="Enter your first name">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Address:</label>
                        <input type="text" name="address" required placeholder="Enter your full address">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>City:</label>
                            <input type="text" name="city" required placeholder="Enter your city">
                        </div>
                        <div class="form-group">
                            <label>y:</label>
                            <select name="country" id="country" required onchange="toggleStateField()">
                                <option value="">Select Country</option>
                                <option value="Argentina">Argentina</option>
                                <option value="Brazil">Brazil</option>
                                <option value="Canada">Canada</option>
                                <option value="Chile">Chile</option>
                                <option value="Colombia">Colombia</option>
                                <option value="Costa Rica">Costa Rica</option>
                                <option value="Ecuador">Ecuador</option>
                                <option value="Honduras">Honduras</option>
                                <option value="Mexico">Mexico</option>
                                <option value="Panamá">Panamá</option>
                                <option value="Peru">Peru</option>
                                <option value="Republica dominicana">Republica dominicana</option>
                                <option value="Spain">Spain</option>
                                <option value="United States">United States</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Zip Code:</label>
                            <input type="text" name="zipCode" required placeholder="Enter zip code">
                        </div>

                        <div class="form-group" id="stateField" style="display: none;">
                            <label>State (Only USA):</label>
                            <input type="text" name="state" id="state" placeholder="If applicable">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Phone/Cell:</label>
                            <input type="tel" name="phoneCell" required placeholder="Enter your phone number">
                        </div>
                        <div class="form-group">
                            <label>Government ID #:</label>
                            <input type="text" name="governmentId" required placeholder="Enter your ID number">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>E-mail:</label>
                            <input type="email" name="email" required placeholder="Enter your email">
                        </div>
                        <div class="form-group">
                            <label>Gender:</label>
                            <select name="gender" required>
                                <option value="">Select Gender</option>
                                <option value="Female">Female</option>
                                <option value="Male">Male</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Date of Birth:</label>
                            <input type="date" name="dateOfBirth" id="dateOfBirth" required onchange="checkAge()">
                        </div>
                        <div class="form-group">
                            <label>Employer (if applicable):</label>
                            <input type="text" name="employer" placeholder="If applicable">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Occupation:</label>
                        <input type="text" name="occupation" placeholder="Enter your occupation">
                    </div>
                </div>

                <!-- Guardian Information Section (will be shown/hidden based on age) -->
                <div class="section guardian-section" id="guardianSection">
                    <h2><i class="fas fa-users"></i> PARENT OR LEGAL GUARDIAN INFORMATION</h2>
                    <p class="section-note">Required for applicants under 18 years of age</p>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Last Name:</label>
                            <input type="text" name="parentLastName" id="parentLastName" placeholder="Enter guardian's last name">
                        </div>
                        <div class="form-group">
                            <label>First Name:</label>
                            <input type="text" name="parentFirstName" id="parentFirstName" placeholder="Enter guardian's first name">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>E-mail:</label>
                            <input type="email" name="parentEmail" id="parentEmail" placeholder="Enter guardian's email">
                        </div>
                        <div class="form-group">
                            <label>Relationship:</label>
                            <input type="text" name="relationship" id="relationship" placeholder="Enter relationship to applicant">
                        </div>
                    </div>

                    <div class="signature-container-parent">
                        <label>Signature of the Parent:</label>
                        <canvas id="signature-pad-parent" width="400" height="200"></canvas>
                        <div class="btn-group">
                            <button type="button" class="secondary" onclick="clearSignatureParent()">Clear Signature</button>
                        </div>
                    </div>
                </div>

                <!-- Admission Information Section -->
                <div class="section">
                    <h2><i class="fas fa-graduation-cap"></i> ADMISSION INFORMATION</h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Select the program level:</label>
                            <select name="programLevel" id="programLevel" required onchange="updatePrograms()">
                                <option value="">Select Level</option>
                                <option value="Graduate +">Graduate +</option>
                                <option value="Graduate">Graduate</option>
                                <option value="Undergraduate">Undergraduate</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Select the Program:</label>
                            <select name="program" id="program" required>
                                <option value="">Select Program</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Select the language of the program:</label>
                            <select name="programLanguage" required>
                                <option value="">Select Language</option>
                                <option value="English">English</option>
                                <option value="Spanish">Spanish</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Select the program delivery:</label>
                            <select name="programDelivery" required>
                                <option value="">Select Delivery</option>
                                <option value="Online">Online</option>
                                <option value="Hybrid">Hybrid</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Select the semester:</label>
                            <select name="semester" id="semester" required>
                                <option value="">Select Semester</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Requirements Section -->
                <div class="section">
                    <h2><i class="fas fa-clipboard-check"></i> CHECK THE REQUIREMENTS FOR ADMISSION THAT YOU ARE SUBMITTING</h2>
                    <p class="section-note">Please confirm all documents you are submitting with your application</p>

                    <div class="requirements">
                        <label id="req1">
                            <input type="checkbox" name="requirementPhotoId">
                            <div>
                                <strong>Official Valid Government ID</strong>
                                <p>Official valid government issued photo identification</p>
                            </div>
                        </label>

                        <label id="req2">
                            <input type="checkbox" name="requirementHighSchool">
                            <div>
                                <strong>High School Diploma</strong>
                                <p>Official high school diploma or equivalent from an accredited, state licensed, or government recognized institution</p>
                            </div>
                        </label>

                        <label id="req3">
                            <input type="checkbox" name="requirementTranscript">
                            <div>
                                <strong>Associate Degree Transcript</strong>
                                <p>If applying with an Associate Degree: an Official transcript from an Accredited or licensed institution</p>
                            </div>
                        </label>

                        <label id="req4">
                            <input type="checkbox" name="requirementAssociateDegree">
                            <div>
                                <strong>Associate Degree Diploma</strong>
                                <p>If applying with an Associate Degree: a Copy of their Associate's Degree Diploma from an Accredited or Licensed institution</p>
                            </div>
                        </label>

                        <label id="req5">
                            <input type="checkbox" name="requirementForeignTranslation">
                            <div>
                                <strong>Foreign Degree Translation</strong>
                                <p>If applying with an Associate Degree: a Certified translation for any foreign degree or transcript and must be equivalent to a U.S. Associate Degree</p>
                            </div>
                        </label>

                        <label id="req6">
                            <input type="checkbox" name="requirementBachelorTranscript">
                            <div>
                                <strong>Bachelor's Degree Transcript</strong>
                                <p>Official transcript or original foreign evaluation showing successful completion of a US equivalent bachelor's degree with a minimum cumulative grade point average of 2.0 from an accredited college or university or equivalent recognition</p>
                            </div>
                        </label>

                        <label id="req7">
                            <input type="checkbox" name="requirementBachelorDiploma">
                            <div>
                                <strong>Bachelor's Degree Diploma</strong>
                                <p>Copy of the Bachelor's Degree Diploma equivalent in the U.S. from an Accredited University, or its equivalent recognition</p>
                            </div>
                        </label>

                        <label id="req8">
                            <input type="checkbox" name="requirementMasterDiploma">
                            <div>
                                <strong>Master's Degree Diploma</strong>
                                <p>Copy of the Master's Degree Diploma equivalent in the U.S. from an Accredited University, or its equivalent recognition.</p>
                            </div>
                        </label>

                        <label id="req9">
                            <input type="checkbox" name="requirementMasterTranscript">
                            <div>
                                <strong>Master's Degree Transcript</strong>
                                <p>Official transcript of the Master's Degree Diploma equivalent in the U.S. from an Accredited University, or its equivalent recognition.</p>
                            </div>
                        </label>

                        <label id="req10">
                            <input type="checkbox" name="requirementBusinessExperience">
                            <div>
                                <strong>Business Experience</strong>
                                <p>Documentation that certifies 4 years of verifiable business experience</p>
                            </div>
                        </label>

                        <label id="req11">
                            <input type="checkbox" name="requirementLanguageCompetency">
                            <div>
                                <strong>Language Competency</strong>
                                <p>Evidence of competency in the language of instruction that you have selected.</p>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- SCHOLARSHIP INFORMATION -->
                <div class="section">
                    <h2><i class="fas fa-award"></i> SCHOLARSHIP INFORMATION</h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Scholarship Type:</label>
                            <select name="scholarshipType" id="scholarshipType" required onchange="toggleFamilyIncome()">
                                <option value="">Select Scholarship</option>
                                <option value="Elizabeth Blackwell Grant">Elizabeth Blackwell Grant</option>
                                <option value="One Academic Scholarship">One Academic Scholarship</option>
                                <option value="Celia Cruz Scholarship">Celia Cruz Scholarship</option>
                            </select>
                        </div>

                        <div class="form-group" id="familyIncomeField" style="display: none;">
                            <label>Family Income:<span class="required">*</span></label>
                            <select name="familyIncome" id="familyIncome">
                                <option value="">Select Income Range</option>
                                <option value="Annual gross income less than $ 20,000.00 in the year prior to the application">Annual gross income less than $ 20,000.00 in the year prior to the application</option>
                                <!--<option value="Annual income $ 20,001.00 and less than $ 40,000.00 in the year prior to the application">Annual income $ 20,001.00 and less than $ 40,000.00 in the year prior to the application</option>-->
                                <!--<option value="Annual income $ 40,001.00 and less than $ 60,000.00 in the year prior to the application">Annual income $ 40,001.00 and less than $ 60,000.00 in the year prior to the application</option>-->
                            </select>
                        </div>
                    </div>
                </div>

                <!-- FERPA Waiver Section -->
                <div class="section">
                    <h2><i class="fas fa-user-shield"></i> FERPA WAIVER FORM</h2>
                    <p class="section-note">This form is to be used by the student to grant access to their records to other persons or entities, such as a parent, spouse, or employer. When completing this form, please print all items clearly to allow for correct processing.</p>

                    <!-- Initial Consent -->
                    <div class="form-group">
                        <label class="consent-label">
                            <input type="checkbox" name="ferpaConsent" id="ferpaConsent" onchange="toggleFerpaContent(this.checked)">
                            <span>I hereby authorize Blackwell Global University to release my educational records to the persons listed below. I understand this authorization will remain in effect until I submit a written request to cancel it.</span>
                        </label>
                    </div>

                    <!-- FERPA Content (hidden by default) -->
                    <div id="ferpaContent" style="display: none;">
                        <!-- Authorized Persons -->
                        <div class="form-row">
                            <div class="form-group">
                                <label>Authorized person's full name:</label>
                                <input type="text" name="ferpaAuthorizedPerson1" placeholder="Enter full name">
                            </div>
                            <div class="form-group">
                                <label>Relationship:</label>
                                <input type="text" name="ferpaRelationship1" placeholder="Enter relationship">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Authorized person's full name:</label>
                                <input type="text" name="ferpaAuthorizedPerson2" placeholder="Enter full name">
                            </div>
                            <div class="form-group">
                                <label>Relationship:</label>
                                <input type="text" name="ferpaRelationship2" placeholder="Enter relationship">
                            </div>
                        </div>

                        <!-- Types of Information -->
                        <div class="requirements ferpa-requirements">
                            <label>
                                <input type="checkbox" name="ferpaAllRecords" onchange="toggleAllFerpaRecords(this.checked)">
                                <div>
                                    <strong>All Records</strong>
                                    <p>Release all educational records</p>
                                </div>
                            </label>

                            <label>
                                <input type="checkbox" name="ferpaAccounting" class="ferpa-specific">
                                <div>
                                    <strong>Accounting</strong>
                                    <p>Includes tuition and fee balances, financial holds, mailing and billing address, payment plans, accounting statements and collections and debt information</p>
                                </div>
                            </label>

                            <label>
                                <input type="checkbox" name="ferpaAdmission" class="ferpa-specific">
                                <div>
                                    <strong>Admission</strong>
                                    <p>Includes dates of application, programs selected, documents received, documents pending, dates of admission, admission status and conditions of admission</p>
                                </div>
                            </label>

                            <label>
                                <input type="checkbox" name="ferpaRegistration" class="ferpa-specific">
                                <div>
                                    <strong>Registration</strong>
                                    <p>Includes current enrollment, dates of enrollment activity, enrollment status, residency status, semesters attended and mailing address information</p>
                                </div>
                            </label>

                            <label>
                                <input type="checkbox" name="ferpaAcademicRecords" class="ferpa-specific">
                                <div>
                                    <strong>Academic Records</strong>
                                    <p>Includes courses taken, grades received, GPA, academic progress, honors, transfer credit awarded and degree(s) awarded</p>
                                </div>
                            </label>

                            <label>
                                <input type="checkbox" name="ferpaFinancialAid" class="ferpa-specific">
                                <div>
                                    <strong>Financial Aid</strong>
                                    <p>Includes all general financial aid information</p>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Signature Section -->
                <div class="section">
                    <h2><i class="fas fa-signature"></i> SIGNATURE</h2>
                    <p class="section-note">Please sign to confirm all information is accurate</p>

                    <div class="form-group">
                        <label>Date:</label>
                        <input type="text" id="currentDate" name="date" readonly class="form-control">
                    </div>

                    <div class="signature-container">
                        <label>Signature of the Applicant:</label>
                        <canvas id="signature-pad" width="400" height="200"></canvas>
                        <div class="btn-group">
                            <button type="button" class="secondary" onclick="clearSignature()">Clear Signature</button>
                        </div>
                    </div>

                    <div class="form-group" style="margin-top: 20px;">
                        <label>
                            <input type="checkbox" name="termsAgreement" required>
                            I certify that all information provided is true and complete to the best of my knowledge
                        </label>
                    </div>

                    <button type="submit" class="submit-btn">Submit Application</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        // URL de tu Google Apps Script desplegado
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzBdhZZ8tE-5ELg6auNFvxM9CPhEKfUdk-pBbBcJErWRJ3lmz_PuGz3t0rUwrhEMH1I/exec';

        async function submitForm(event) {
    event.preventDefault();

    if (!validateForm(event)) {
        return;
    }

    // Mostrar loading
    Swal.fire({
        title: 'Enviando formulario...',
        text: 'Por favor espere',
        allowOutsideClick: false,
        showConfirmButton: false,
        willOpen: () => {
            Swal.showLoading();
        }
    });

    const formData = {};
    const form = document.getElementById('admissionForm');

    // Recoger todos los datos del formulario
    new FormData(form).forEach((value, key) => {
        if (key.startsWith('requirement')) {
            formData[key] = value === 'on';
        } else if (key.startsWith('ferpa')) { // Handle FERPA checkboxes
             formData[key] = value === 'on' ? true : value; // Store 'on' as true, keep other values
        } else {
            formData[key] = value;
        }
    });

    // Añadir ambas firmas
    const canvas = document.getElementById('signature-pad');
    const canvasParent = document.getElementById('signature-pad-parent');
    formData.signature = canvas.toDataURL();
    formData.signatureParent = canvasParent.toDataURL(); // Always include, even if blank initially

    try {
        const response = await fetch(SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify(formData)
        });

        const result = await response.json();

        if (result.success) {
            // --- Modification Starts Here ---
            let titleClickCount = 0; // Counter for title clicks
            const requiredClicks = 7;

            Swal.fire({
                title: '¡Solicitud Enviada!', // This is the clickable title
                html: `
                    <h2 style="color: #0078D4; font-size: 1.3rem; margin-bottom: 1.2rem; text-align: center; font-family: 'Segoe UI', sans-serif;">Your request has been processed successfully.</h2>
                    
                    <!-- Links container - initially hidden -->
                    <div id="documentLinksContainer" style="display: none; flex-direction: column; gap: 8px; max-width: 400px; margin: 0 auto;">
                        ${[
                            { url: result.applicationUrl, text: 'Application Form' },
                            { url: result.acceptanceUrl, text: 'Acceptance Letter' },
                            ...(result.scholarshipUrl ? [{ url: result.scholarshipUrl, text: 'Grant Scholarship Letter' }] : []),
                            { url: result.enrollmentUrl, text: 'Enrollment Agreement' },
                            { url: result.fifthDocumentUrl, text: 'Commitment Letter' },
                            { url: result.grantApplicationUrl, text: 'Grant Application Form' },
                            { url: result.updateFinancialUrl, text: 'Financial Update Letter' },
                            { url: result.ferpaUrl, text: 'FERPA Waiver' }
                        ].map(link => `
                            <a href="${link.url}" target="_blank"
                               style="background: #0078D4;
                                      color: white !important;
                                      padding: 0.7rem 1rem;
                                      border-radius: 4px;
                                      text-decoration: none;
                                      font-size: 0.95rem;
                                      text-align: center;
                                      font-weight: 500;
                                      transition: all 0.2s ease;
                                      border: none;
                                      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                                      margin: 3px 0;
                                      font-family: 'Segoe UI', sans-serif;"
                               onmouseover="this.style.background='#106EBE'"
                               onmouseout="this.style.background='#0078D4'">${link.text}</a>
                        `).join('')}
                    </div>

                    <!-- Close button remains visible -->
                    <div style="text-align: center; margin-top: 1rem;">
                        <button onclick="location.reload()"
                                style="background: #F3F2F1;
                                       color: #323130;
                                       padding: 0.7rem 2rem;
                                       border-radius: 4px;
                                       border: none;
                                       font-size: 0.95rem;
                                       font-weight: 500;
                                       cursor: pointer;
                                       box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                                       margin-top: 10px;
                                       font-family: 'Segoe UI', sans-serif;
                                       transition: all 0.2s ease;"
                                onmouseover="this.style.background='#E1DFDD'"
                                onmouseout="this.style.background='#F3F2F1'">Close</button>
                    </div>`,
                icon: 'success',
                showConfirmButton: false,
                showCloseButton: true,
                allowOutsideClick: false, // Keep modal open while clicking title
                didOpen: () => {
                    // Find the title element within the modal
                    const titleElement = Swal.getTitle();
                    // Find the hidden links container
                    const linksContainer = Swal.getHtmlContainer().querySelector('#documentLinksContainer');

                    if (titleElement && linksContainer) {
                         // Add the click listener to the title
                         const titleClickHandler = () => {
                            titleClickCount++;
                            console.log(`Title clicked ${titleClickCount} times.`); // Optional: for debugging
                            if (titleClickCount >= requiredClicks) {
                                console.log('Showing links!'); // Optional: for debugging
                                linksContainer.style.display = 'flex'; // Show the links
                                // Optional: Remove the listener after showing links
                                titleElement.removeEventListener('click', titleClickHandler);
                                titleElement.style.cursor = 'default'; // Change cursor back
                            }
                        };

                        titleElement.style.cursor = 'pointer'; // Indicate the title is clickable
                        titleElement.addEventListener('click', titleClickHandler);
                    } else {
                        console.error("Could not find SweetAlert title or links container");
                    }
                }
            });
            // --- Modification Ends Here ---

            // Opcional: limpiar el formulario
            form.reset();
            clearSignature();
            clearSignatureParent();
            // Reset UI states
            toggleStateField();
            toggleFamilyIncome();
            checkAge();
            updatePrograms();
            toggleFerpaContent(false);
        } else {
            Swal.fire({
                title: 'Error',
                text: result.error || 'Hubo un error al procesar tu solicitud',
                icon: 'error'
            });
        }
    } catch (error) {
        Swal.fire({
            title: 'Error',
            text: 'Error al enviar el formulario: ' + error.message,
            icon: 'error'
        });
    }
}

        // Set current date in text format
        window.onload = function() {
            const today = new Date();
            const options = {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            };
            document.getElementById('currentDate').value = today.toLocaleDateString('en-US', options);

            // Initialize signature pads on load
            setupSignaturePad(canvas, ctx);
            setupSignaturePad(canvasParent, ctxParent);
        };

        // Check age and show/hide guardian section
        function checkAge() {
            const dobInput = document.getElementById('dateOfBirth');
            const guardianSection = document.getElementById('guardianSection');
            const guardianFields = ['parentLastName', 'parentFirstName', 'parentEmail', 'relationship'];

            if (!dobInput.value) {
                guardianSection.classList.remove('visible');
                 guardianFields.forEach(fieldId => {
                     const field = document.getElementById(fieldId);
                     if(field) field.required = false;
                 });
                return; // Exit if no date is selected
            }

            const dob = new Date(dobInput.value);
            const today = new Date();
            let age = today.getFullYear() - dob.getFullYear();
            const monthDiff = today.getMonth() - dob.getMonth();

            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < dob.getDate())) {
                age--;
            }

            if (age < 18) {
                guardianSection.classList.add('visible');
                guardianFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if(field) field.required = true;
                });
                // Ensure parent signature pad is initialized when shown
                setupSignaturePad(canvasParent, ctxParent);
            } else {
                guardianSection.classList.remove('visible');
                guardianFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if(field) field.required = false;
                });
            }
        }

        // Update programs based on program level
        function updatePrograms() {
            const programLevel = document.getElementById('programLevel').value;
            const programSelect = document.getElementById('program');
            const semesterSelect = document.getElementById('semester');

            // Limpiar opciones actuales
            programSelect.innerHTML = '<option value="">Select Program</option>';
            semesterSelect.innerHTML = '<option value="">Select Semester</option>';

            // Ocultar todos los requisitos primero
            for (let i = 1; i <= 11; i++) {
                const reqLabel = document.getElementById(`req${i}`);
                if(reqLabel) reqLabel.style.display = 'none';
            }

            let programs = [];
            let semesters = [];
            let showReqs = [];

            if (programLevel === 'Graduate +') {
                showReqs = [1, 8, 9, 10, 11];
                programs = ['Doctorate in Business Administration'];
                semesters = ['April 28, 2025', 'June 23, 2025'];
            } else if (programLevel === 'Graduate') {
                showReqs = [1, 6, 7, 11];
                programs = [
                    'Master of Business Administration',
                    'Master of Science in Hospitality Management',
                    'Master of Science in Healthcare Management',
                    'Master of Science in Project Management',
                    'Master of Science in Artificial Intelligence',
                    'Master of Science in Cybersecurity',
                    'Master of Science in Renewable Energy and Sustainability Systems',
                    'Master of Science in Criminal Justice'
                ];
                semesters = ['April 28, 2025', 'May 26, 2025', 'June 23, 2025', 'July 21, 2025'];
            } else if (programLevel === 'Undergraduate') {
                showReqs = [1, 2, 3, 4, 5, 11];
                programs = [
                    'Bachelor of Arts in Accounting',
                    'Bachelor of Science in Business Administration',
                    'Upgrade of Arts in Accounting',
                    'Upgrade of Science in Business Administration'
                ];
                semesters = ['April 21, 2025', 'May 26, 2025', 'June 30, 2025'];
            }

             // Mostrar requisitos específicos
            showReqs.forEach(num => {
                 const reqLabel = document.getElementById(`req${num}`);
                if(reqLabel) reqLabel.style.display = 'flex';
            });

            // Actualizar programas
            programs.forEach(program => {
                const option = document.createElement('option');
                option.value = program;
                option.textContent = program;
                programSelect.appendChild(option);
            });

            // Actualizar semestres
            semesters.forEach(semester => {
                const option = document.createElement('option');
                option.value = semester;
                option.textContent = semester;
                semesterSelect.appendChild(option);
            });
        }

        // Función para mostrar/ocultar campo de estado
        function toggleStateField() {
            const country = document.getElementById('country').value;
            const stateField = document.getElementById('stateField');
            const stateInput = document.getElementById('state');

            if (country === 'United States') {
                stateField.style.display = 'block';
                stateInput.required = true;
            } else {
                stateField.style.display = 'none';
                stateInput.required = false;
                stateInput.value = '';
            }
        }

        // Función para mostrar/ocultar campo de ingreso familiar
        function toggleFamilyIncome() {
            const scholarshipType = document.getElementById('scholarshipType').value;
            const familyIncomeField = document.getElementById('familyIncomeField');
            const familyIncomeSelect = document.getElementById('familyIncome');

            if (scholarshipType === 'Elizabeth Blackwell Grant') {
                familyIncomeField.style.display = 'block';
                familyIncomeSelect.required = true;
            } else {
                familyIncomeField.style.display = 'none';
                familyIncomeSelect.required = false;
                familyIncomeSelect.value = '';
            }
        }

        // Signature pad global variables
        const canvas = document.getElementById('signature-pad');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;

        const canvasParent = document.getElementById('signature-pad-parent');
        const ctxParent = canvasParent.getContext('2d');
        let isDrawingParent = false;

        // Generic function to set up a signature pad
        function setupSignaturePad(padCanvas, padCtx) {
            padCanvas.width = padCanvas.offsetWidth;
            // Ensure height is set explicitly if offsetHeight isn't reliable
            padCanvas.height = 200; // or padCanvas.offsetHeight;
            padCtx.lineWidth = 2;
            padCtx.strokeStyle = '#000000';
            padCtx.lineCap = 'round'; // Smoother lines
            padCtx.lineJoin = 'round';

             // Clear any previous drawings if re-initializing
            padCtx.clearRect(0, 0, padCanvas.width, padCanvas.height);
        }

        // Event handlers for the main signature pad
        canvas.addEventListener('mousedown', (e) => startDrawing(e, canvas, ctx, 'main'));
        canvas.addEventListener('mousemove', (e) => draw(e, canvas, ctx, 'main'));
        canvas.addEventListener('mouseup', () => stopDrawing('main'));
        canvas.addEventListener('mouseout', () => stopDrawing('main'));
        canvas.addEventListener('touchstart', (e) => { e.preventDefault(); startDrawing(e.touches[0], canvas, ctx, 'main'); });
        canvas.addEventListener('touchmove', (e) => { e.preventDefault(); draw(e.touches[0], canvas, ctx, 'main'); });
        canvas.addEventListener('touchend', () => stopDrawing('main'));

        // Event handlers for the parent signature pad
        canvasParent.addEventListener('mousedown', (e) => startDrawing(e, canvasParent, ctxParent, 'parent'));
        canvasParent.addEventListener('mousemove', (e) => draw(e, canvasParent, ctxParent, 'parent'));
        canvasParent.addEventListener('mouseup', () => stopDrawing('parent'));
        canvasParent.addEventListener('mouseout', () => stopDrawing('parent'));
        canvasParent.addEventListener('touchstart', (e) => { e.preventDefault(); startDrawing(e.touches[0], canvasParent, ctxParent, 'parent'); });
        canvasParent.addEventListener('touchmove', (e) => { e.preventDefault(); draw(e.touches[0], canvasParent, ctxParent, 'parent'); });
        canvasParent.addEventListener('touchend', () => stopDrawing('parent'));

        function getMousePos(padCanvas, evt) {
            const rect = padCanvas.getBoundingClientRect();
            return {
                x: evt.clientX - rect.left,
                y: evt.clientY - rect.top
            };
        }

        function startDrawing(e, padCanvas, padCtx, type) {
            if (type === 'main') isDrawing = true;
            else if (type === 'parent') isDrawingParent = true;

            const pos = getMousePos(padCanvas, e);
            padCtx.beginPath();
            padCtx.moveTo(pos.x, pos.y);
        }

        function draw(e, padCanvas, padCtx, type) {
            let drawingFlag = (type === 'main') ? isDrawing : isDrawingParent;
            if (!drawingFlag) return;

            const pos = getMousePos(padCanvas, e);
            padCtx.lineTo(pos.x, pos.y);
            padCtx.stroke();
            // Keep the path open for continuous drawing
            // padCtx.beginPath(); // Removing this makes lines smoother
            // padCtx.moveTo(pos.x, pos.y); // Removing this makes lines smoother
        }

        function stopDrawing(type) {
            if (type === 'main') isDrawing = false;
            else if (type === 'parent') isDrawingParent = false;
            // Lift the pen by starting a new path without moving
            if(type === 'main') ctx.beginPath();
            else ctxParent.beginPath();
        }

        function clearSignature() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
             setupSignaturePad(canvas, ctx); // Re-setup defaults
        }

        function clearSignatureParent() {
            ctxParent.clearRect(0, 0, canvasParent.width, canvasParent.height);
             setupSignaturePad(canvasParent, ctxParent); // Re-setup defaults
        }

        // Form validation
        function validateForm(event) {
            // Check if applicant signature exists
            if (!isCanvasSigned(canvas, ctx)) {
                Swal.fire({
                    title: 'Signature Required',
                    text: 'Please sign the Applicant Signature section before submitting.',
                    icon: 'warning'
                });
                return false;
            }

            // Check if guardian signature is required and exists
             const guardianSection = document.getElementById('guardianSection');
             if (guardianSection.classList.contains('visible') && !isCanvasSigned(canvasParent, ctxParent)) {
                 Swal.fire({
                     title: 'Guardian Signature Required',
                     text: 'Please ensure the Parent or Legal Guardian signs the form.',
                     icon: 'warning'
                 });
                 return false;
             }

             // Validate FERPA if consent is given
            const ferpaConsent = document.getElementById('ferpaConsent').checked;
            if (ferpaConsent) {
                const authorizedPerson1 = document.querySelector('[name="ferpaAuthorizedPerson1"]').value.trim();
                const relationship1 = document.querySelector('[name="ferpaRelationship1"]').value.trim();
                const authorizedPerson2 = document.querySelector('[name="ferpaAuthorizedPerson2"]').value.trim();
                const relationship2 = document.querySelector('[name="ferpaRelationship2"]').value.trim();
                const recordCheckboxes = document.querySelectorAll('.ferpa-requirements input[type="checkbox"]');
                let atLeastOneRecordChecked = false;
                recordCheckboxes.forEach(cb => {
                    if (cb.checked) atLeastOneRecordChecked = true;
                });

                // Require at least one authorized person
                if (!authorizedPerson1 && !authorizedPerson2) {
                     Swal.fire('FERPA Validation', 'Please provide details for at least one authorized person.', 'warning');
                     return false;
                }
                 // If person 1 is named, relationship is required
                if (authorizedPerson1 && !relationship1) {
                     Swal.fire('FERPA Validation', 'Please provide the relationship for the first authorized person.', 'warning');
                     return false;
                }
                 // If person 2 is named, relationship is required
                if (authorizedPerson2 && !relationship2) {
                     Swal.fire('FERPA Validation', 'Please provide the relationship for the second authorized person.', 'warning');
                     return false;
                }

                // Require at least one type of record to be selected
                if (!atLeastOneRecordChecked) {
                    Swal.fire('FERPA Validation', 'Please select at least one type of record to release.', 'warning');
                    return false;
                }
            }


            return true; // Form is valid
        }

        // Helper function to check if a canvas has been signed
        function isCanvasSigned(padCanvas, padCtx) {
             // Check if canvas is empty by checking pixel data
            const pixelBuffer = new Uint32Array(
                padCtx.getImageData(0, 0, padCanvas.width, padCanvas.height).data.buffer
            );
            // Check if any pixel is not transparent (or not white if background is white)
            return pixelBuffer.some(color => color !== 0); // Checks for non-transparent pixels
        }

        // ----- FERPA Logic -----

        // Function to show/hide the FERPA content section
        function toggleFerpaContent(checked) {
            const ferpaContent = document.getElementById('ferpaContent');
            const inputs = ferpaContent.querySelectorAll('input[type="text"], input[type="checkbox"]');

            if (checked) {
                ferpaContent.style.display = 'block';
                // You might want to make fields required here if consent is given
                 // Example: document.querySelector('[name="ferpaAuthorizedPerson1"]').required = true;
            } else {
                ferpaContent.style.display = 'none';
                // Clear fields and remove 'required' attribute if consent is withdrawn
                inputs.forEach(input => {
                    if (input.type === 'checkbox') {
                        input.checked = false;
                    } else {
                        input.value = '';
                    }
                    input.required = false;
                });
            }
        }

        // Function for the "All Records" checkbox behavior
        function toggleAllFerpaRecords(checked) {
            const specificCheckboxes = document.querySelectorAll('.ferpa-specific');
            specificCheckboxes.forEach(checkbox => {
                checkbox.checked = checked;
            });
        }

        // Function to check if all specific FERPA records are checked
        function checkAllSpecifics() {
            const specificCheckboxes = document.querySelectorAll('.ferpa-specific');
            const allChecked = Array.from(specificCheckboxes).every(checkbox => checkbox.checked);
            document.querySelector('[name="ferpaAllRecords"]').checked = allChecked;
        }

        // Add event listeners to specific FERPA checkboxes
        document.querySelectorAll('.ferpa-specific').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                if (!this.checked) {
                    // If any specific box is unchecked, uncheck "All Records"
                    document.querySelector('[name="ferpaAllRecords"]').checked = false;
                } else {
                    // If this box is checked, check if all others are too
                    checkAllSpecifics();
                }
            });
        });

        // Initial setup calls on page load
        checkAge();
        updatePrograms();
        toggleStateField();
        toggleFamilyIncome();
        toggleFerpaContent(document.getElementById('ferpaConsent').checked); // Initial check for FERPA visibility

    </script>

    <!-- Optional: Waves Animation Background (if you have the CSS for it) -->
    <!--
    <div class="waves-container">
        <div class="wave wave1"></div>
        <div class="wave wave2"></div>
        <div class="wave wave3"></div>
        <div class="wave wave4"></div>
    </div>
    -->
</body>
</html>
